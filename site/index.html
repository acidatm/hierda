<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Von Hier nach Da</title>
    <style media="screen">
      *{
        appearance: none;
      }
      body{
        padding: 2rem;
        font-family: serif;
        font-size:2vh;
        line-height:1.5em;
      }
      h1{
        font-weight: bold;
        text-align: center;
      }
      h2{
        font-style: italic;
        text-align: center;
      }
      #out{
        width: 100%;
        max-width: 480px;
        margin: 0 auto;
      }
      p{
        margin: 0;
        margin-bottom: 0.5em;
      }
    </style>
  </head>
  <body>
    <h1>Von Hier nach Da</h1><br>
    <h2>Johannes Hassenstein</h2><br>
    <div id="out"></div>
    <script>
      function generate(paragraphs,total){ //generates a random text based on array of paragraphs passed
        function noise(seed,n){ //sine based noise function that takes a seed and a position
          return (1 + Math.sin((seed + n) * 10000)) * 0.5
        }
        let hier = 0
        let da = 0
        let tp = 0.75 //turning point
        let seed = Math.random() * 10000 //unique noise seed
        let i = 0 //global counter
        let out = [] //output array
        for(let paragraph of paragraphs){ //for each paragraph
          out.push("<p>")
          let p = paragraph //store to counter
          while(p > 0){ //iterate
            let un = noise(seed,i) //unique nouse value for this pos
            let r = i / total //relative progress through text
            let n = r < tp ? r / tp : 1 - ((r - tp) / (1 - tp)) //how much noise is introduced
            let v = r * (1-n) + un * n
            v = v < 0.5 ? 0 : 1
            if(v && da < total * 0.5){
              da++
              out.push("Da")
            }
            else if(hier < total * 0.5){
              hier++
              out.push("Hier")
            }
            else{
              if(hier < da){
                hier++
                out.push("Hier")
              }
              else{
                da++
                out.push("Hier")
              }
            }
            i++ //increment global counter
            p-- //decrement paragraph counter
          }
          out.push("</p>") //insert a break with paragraph end
        }
        return out.join(" ") //return joined output
      }
      const paragraphs = [3,4,8,9,2,3,1,11,6,8,3,12,3,7,6,14,6,6,7,6,9,10,14,3,4,3,9,4,6,3,8,2]
      let total = 0
      for(let p of paragraphs){
        total += p
      }
      window.addEventListener("load",function(){
        document.getElementById("out").innerHTML = generate(paragraphs,total)
      })
    </script>
  </body>
</html>
